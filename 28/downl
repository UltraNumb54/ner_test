from huggingface_hub import snapshot_download
from transformers import AutoTokenizer, AutoModelForTokenClassification
import os

# Явно скачиваем модель в указанную директорию
model_name = "bert-base-multilingual-cased"
local_dir = "./bert-base-multilingual-cased"

print(f"Скачивание модели {model_name}...")
try:
    # Скачиваем все файлы модели
    snapshot_download(
        repo_id=model_name,
        local_dir=local_dir,
        local_dir_use_symlinks=False,  # избегаем симлинков
        force_download=True,  # принудительно перезаписываем
        resume_download=False
    )
    print(f"Модель успешно скачана в {local_dir}")
except Exception as e:
    print(f"Ошибка при скачивании: {e}")

# Проверяем загрузку
print("Проверка загрузки...")
try:
    tokenizer = AutoTokenizer.from_pretrained(local_dir)
    model = AutoModelForTokenClassification.from_pretrained(local_dir)
    print("✅ Модель и токенизатор успешно загружены локально")
except Exception as e:
    print(f"❌ Ошибка при проверке: {e}")